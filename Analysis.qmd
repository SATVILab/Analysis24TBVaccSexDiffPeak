---
title: Analyse peak response
format:
  html:
    embed-resources: true
---

```{r}
#| include: false
library(ggplot2)
library(tibble)
```


## Data prep

Here we load the data:

```{r}
library(DataTidy24TBVaccSexDiff)
data("data_tidy_vacc_freq")
```

Here we extract the peak response:

```{r}
data_tidy_vacc_peak <- data_tidy_vacc_freq |>
  vacc_extract_peak()
data_tidy_vacc_peak
```

Now we calculate the summed response and the peak response:

```{r}
data_tidy_vacc_summed <- data_tidy_vacc_peak |>
  vacc_calc_response_summed("response") |>
  vacc_set_neg_to_zero("response")
data_tidy_vacc_summed
data_tidy_vacc_profile <- data_tidy_vacc_peak |>
  vacc_calc_response_profile("response")
data_tidy_vacc_profile
```

## Analysis

Kruskal-Wallis Test:

```{r}
vacc_inf_sex <- with(data_tidy_vacc_peak, interaction(vaccine, infxn, sex))
test <- kruskal.test(response ~ vacc_inf_sex, data = data_tidy_vacc_peak)
test
```

Load betareg package:

```{r}
#install.packages('betareg')
library(betareg)
```

Load gamlss package:

```{r}
#install.packages('gamlss')
library(gamlss)
```



